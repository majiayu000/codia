# UI/UX 设计文档

> **项目**: AI Virtual Companion (Codia)
>
> **作者**: Design Team
>
> **状态**: Draft → Review → Approved
>
> **创建日期**: 2026-01-04
>
> **最后更新**: 2026-01-04
>
> **审阅者**: @product-team, @engineering-team

---

## 变更记录

| 版本 | 日期 | 作者 | 变更说明 |
|------|------|------|----------|
| v1.0 | 2026-01-04 | Design Team | 初始版本 |

---

## 目录

1. [设计理念](#1-设计理念)
2. [用户体验目标](#2-用户体验目标)
3. [设计系统](#3-设计系统)
4. [页面结构与布局](#4-页面结构与布局)
5. [核心交互流程](#5-核心交互流程)
6. [组件规范](#6-组件规范)
7. [响应式设计](#7-响应式设计)
8. [动效设计](#8-动效设计)
9. [可访问性设计](#9-可访问性设计)
10. [设计交付物](#10-设计交付物)

---

## 1. 设计理念

### 1.1 设计原则

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           设计原则                                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  1. 沉浸优先 (Immersion First)                                          │
│     • 3D 角色为视觉焦点，UI 元素尽量简化                                │
│     • 减少视觉干扰，让用户专注于与角色的交互                            │
│     • 使用透明/半透明元素避免遮挡角色                                   │
│                                                                         │
│  2. 情感连接 (Emotional Connection)                                     │
│     • 角色表情响应用户情绪和对话内容                                    │
│     • 平滑的动画过渡增强真实感                                          │
│     • 温暖柔和的色调营造舒适氛围                                        │
│                                                                         │
│  3. 零门槛使用 (Zero Friction)                                          │
│     • 首次进入即可开始对话，无需复杂设置                                │
│     • 默认配置即可使用，高级选项渐进展示                                │
│     • 清晰的视觉引导和操作反馈                                          │
│                                                                         │
│  4. 隐私安全感 (Privacy Assurance)                                      │
│     • 明确的隐私状态指示器                                              │
│     • 本地处理的视觉暗示                                                │
│     • 数据存储位置透明展示                                              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.2 设计风格

| 维度 | 风格描述 | 示例 |
|------|----------|------|
| **整体风格** | 现代简约 + 温暖柔和 | 类似 Notion、Linear 的简洁感 |
| **色彩基调** | 暖色系为主，冷色系点缀 | 米白背景 + 粉紫渐变强调色 |
| **视觉层次** | 3D 角色 > 对话 > 控制面板 | 角色占据 60%+ 视觉权重 |
| **字体风格** | 现代无衬线，友好圆润 | Noto Sans SC / Inter |
| **图标风格** | 线性图标，圆角风格 | Lucide / Phosphor Icons |
| **动效风格** | 自然流畅，弹性动画 | Spring 动画，缓动曲线 |

### 1.3 情绪板 (Mood Board)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           Mood Board                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  关键词: 温暖 | 陪伴 | 舒适 | 现代 | 简洁 | 沉浸                        │
│                                                                         │
│  参考风格:                                                              │
│  ├── VTuber 直播界面 (3D 角色展示)                                      │
│  ├── Apple 人机交互 (简洁克制)                                          │
│  ├── Calm/Headspace (柔和配色)                                          │
│  ├── Discord/Slack (聊天界面)                                           │
│  └── Spotify (暗色模式氛围)                                             │
│                                                                         │
│  颜色氛围:                                                              │
│  ├── 日间模式: 暖白 + 淡粉紫渐变                                        │
│  └── 夜间模式: 深蓝黑 + 星空紫渐变                                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 用户体验目标

### 2.1 UX 成功指标

| 指标 | 目标值 | 衡量方式 |
|------|--------|----------|
| **首次使用完成率** | ≥80% | 从首页到首次对话完成 |
| **任务完成率** | ≥90% | 核心任务成功率 |
| **SUS 评分** | ≥75 | 系统可用性量表 |
| **错误恢复率** | ≥85% | 用户能从错误中恢复 |
| **加载等待容忍** | <3s | 用户不因加载放弃 |

### 2.2 关键用户旅程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     用户旅程地图 - 首次使用                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  阶段        发现        首次访问      设置        对话        留存     │
│  ───────────────────────────────────────────────────────────────────── │
│                                                                         │
│  触点     社交媒体      着陆页       快速设置    主界面      通知/邮件  │
│           分享链接      首页         引导流程    对话界面              │
│                                                                         │
│  行动     点击链接      浏览首页     选择角色    发送消息    再次访问   │
│                        点击开始     配置 API    语音输入              │
│                                                                         │
│  想法     "看起来       "这是什么    "设置简单   "好真实     "想再来    │
│           很有趣"       能做什么"    吗？"       有意思"     聊聊"     │
│                                                                         │
│  情绪       😯            🤔           😐→😊        😊😍        😌      │
│           好奇          探索         期待→满意   惊喜       满足     │
│                                                                         │
│  痛点     不确定是否    不清楚       API 配置    初次响应    忘记再来   │
│           安全          功能差异     可能复杂    可能慢     使用       │
│                                                                         │
│  机会     清晰价值      即时演示     简化配置    加载动画    提醒功能   │
│           主张          视频预览     一键默认    预热缓存   每日话题   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.3 情感设计曲线

```
满意度
  ↑
5 │                              ┌──────────────────
  │                           ┌──┘  对话流畅
4 │                        ┌──┘     表情响应
  │                 角色  ┌┘
3 │              加载完成─┘
  │           ┌──┘
2 │  等待加载 ┘
  │
1 │
  └─────────────────────────────────────────────────→ 时间
    访问  加载   首次   开始   收到   持续   结束
                交互   对话   回复   对话   会话
```

---

## 3. 设计系统

### 3.1 色彩系统

#### 主色调

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          Color Palette                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Primary (主色 - 互动/强调)                                             │
│  ├── primary-50:   #FDF4FF  (最浅)                                      │
│  ├── primary-100:  #FAE8FF                                              │
│  ├── primary-200:  #F5D0FE                                              │
│  ├── primary-300:  #F0ABFC                                              │
│  ├── primary-400:  #E879F9                                              │
│  ├── primary-500:  #D946EF  ← 主色                                      │
│  ├── primary-600:  #C026D3                                              │
│  ├── primary-700:  #A21CAF                                              │
│  ├── primary-800:  #86198F                                              │
│  └── primary-900:  #701A75  (最深)                                      │
│                                                                         │
│  Secondary (辅色 - 背景/卡片)                                           │
│  ├── secondary-50:  #F8FAFC                                             │
│  ├── secondary-100: #F1F5F9                                             │
│  ├── secondary-200: #E2E8F0                                             │
│  ├── secondary-300: #CBD5E1                                             │
│  ├── secondary-400: #94A3B8                                             │
│  ├── secondary-500: #64748B ← 辅色                                      │
│  ├── secondary-600: #475569                                             │
│  ├── secondary-700: #334155                                             │
│  ├── secondary-800: #1E293B                                             │
│  └── secondary-900: #0F172A                                             │
│                                                                         │
│  Accent (强调色 - 语音/状态)                                            │
│  ├── accent-cyan:   #22D3EE  (语音输入激活)                             │
│  ├── accent-green:  #22C55E  (成功/在线)                                │
│  ├── accent-amber:  #F59E0B  (警告/处理中)                              │
│  └── accent-red:    #EF4444  (错误/离线)                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 语义化颜色

```typescript
// CSS Variables (Tailwind Config)
const semanticColors = {
  // 背景
  'bg-canvas': 'var(--secondary-50)',     // 画布背景
  'bg-surface': 'var(--white)',            // 卡片/面板背景
  'bg-overlay': 'rgba(0,0,0,0.5)',        // 遮罩层

  // 文字
  'text-primary': 'var(--secondary-900)', // 主要文字
  'text-secondary': 'var(--secondary-600)', // 次要文字
  'text-muted': 'var(--secondary-400)',   // 禁用/占位文字
  'text-inverse': 'var(--white)',         // 反色文字

  // 边框
  'border-default': 'var(--secondary-200)',
  'border-hover': 'var(--secondary-300)',
  'border-focus': 'var(--primary-500)',

  // 状态
  'status-online': 'var(--accent-green)',
  'status-processing': 'var(--accent-amber)',
  'status-error': 'var(--accent-red)',
  'status-voice': 'var(--accent-cyan)',
};
```

#### 暗色模式

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        Dark Mode Palette                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  背景层级                                                               │
│  ├── bg-canvas:  #0F0F1A  (深蓝黑 - 最底层)                             │
│  ├── bg-surface: #1A1A2E  (卡片背景)                                    │
│  ├── bg-elevated: #252540 (弹窗/浮层)                                   │
│  └── bg-overlay: rgba(0,0,0,0.7)                                        │
│                                                                         │
│  文字                                                                   │
│  ├── text-primary:   #F8FAFC                                            │
│  ├── text-secondary: #94A3B8                                            │
│  └── text-muted:     #64748B                                            │
│                                                                         │
│  强调色保持高对比度，提升亮度 10%                                        │
│  ├── primary: #E879F9 (比日间模式亮)                                    │
│  └── accent 系列保持不变                                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.2 字体系统

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        Typography Scale                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  字体族                                                                 │
│  ├── 主字体: Inter (英文) / Noto Sans SC (中文)                         │
│  ├── 代码字体: JetBrains Mono                                           │
│  └── 回退: system-ui, sans-serif                                        │
│                                                                         │
│  字号梯度 (rem)                                                         │
│  ├── text-xs:   0.75rem (12px)  - 标签、说明文字                        │
│  ├── text-sm:   0.875rem (14px) - 次要内容、按钮                        │
│  ├── text-base: 1rem (16px)     - 正文、输入框                          │
│  ├── text-lg:   1.125rem (18px) - 卡片标题                              │
│  ├── text-xl:   1.25rem (20px)  - 小标题                                │
│  ├── text-2xl:  1.5rem (24px)   - 区块标题                              │
│  ├── text-3xl:  1.875rem (30px) - 页面标题                              │
│  └── text-4xl:  2.25rem (36px)  - 大标题                                │
│                                                                         │
│  字重                                                                   │
│  ├── font-normal:   400  (正文)                                         │
│  ├── font-medium:   500  (强调)                                         │
│  ├── font-semibold: 600  (标题)                                         │
│  └── font-bold:     700  (按钮、重要)                                   │
│                                                                         │
│  行高                                                                   │
│  ├── leading-tight:  1.25 (标题)                                        │
│  ├── leading-normal: 1.5  (正文)                                        │
│  └── leading-relaxed: 1.75 (长文本)                                     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.3 间距系统

```typescript
// 4px 基础单位的间距系统
const spacing = {
  0:    '0px',
  0.5:  '2px',
  1:    '4px',
  1.5:  '6px',
  2:    '8px',
  2.5:  '10px',
  3:    '12px',
  4:    '16px',
  5:    '20px',
  6:    '24px',
  8:    '32px',
  10:   '40px',
  12:   '48px',
  16:   '64px',
  20:   '80px',
  24:   '96px',
};

// 语义化间距
const semanticSpacing = {
  'page-padding': 'spacing.6',     // 24px - 页面边距
  'section-gap': 'spacing.8',      // 32px - 区块间距
  'card-padding': 'spacing.4',     // 16px - 卡片内边距
  'input-padding': 'spacing.3',    // 12px - 输入框内边距
  'button-padding-x': 'spacing.4', // 16px - 按钮水平内边距
  'button-padding-y': 'spacing.2', // 8px  - 按钮垂直内边距
};
```

### 3.4 圆角系统

```typescript
const borderRadius = {
  none:   '0px',
  sm:     '4px',    // 小元素 (标签、徽章)
  DEFAULT: '8px',   // 默认 (按钮、输入框)
  md:     '12px',   // 卡片
  lg:     '16px',   // 面板
  xl:     '24px',   // 大卡片、弹窗
  '2xl':  '32px',   // 特殊强调
  full:   '9999px', // 圆形、胶囊
};
```

### 3.5 阴影系统

```typescript
const boxShadow = {
  sm:     '0 1px 2px 0 rgb(0 0 0 / 0.05)',
  DEFAULT: '0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)',
  md:     '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)',
  lg:     '0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)',
  xl:     '0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)',

  // 特殊阴影
  'glow-primary': '0 0 20px rgb(217 70 239 / 0.3)', // 主色发光
  'glow-voice':   '0 0 20px rgb(34 211 238 / 0.4)', // 语音激活发光
  inner:  'inset 0 2px 4px 0 rgb(0 0 0 / 0.05)',
};
```

---

## 4. 页面结构与布局

### 4.1 整体布局架构

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        Main Layout (Desktop)                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Header (固定高度 56px)                                          │   │
│  │  ┌──────┐                               ┌──────┬──────┬──────┐  │   │
│  │  │ Logo │         [空白]               │ 主题 │ 设置 │ 用户 │  │   │
│  │  └──────┘                               └──────┴──────┴──────┘  │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌───────────────────────────────────┬─────────────────────────────┐   │
│  │                                   │                             │   │
│  │                                   │                             │   │
│  │                                   │      Sidebar Panel          │   │
│  │         3D Character              │      (可收起, 320px)        │   │
│  │         Canvas                    │                             │   │
│  │         (自适应)                  │      ┌─────────────────┐   │   │
│  │                                   │      │  Chat Messages  │   │   │
│  │         角色渲染区域              │      │                 │   │   │
│  │         占据主要视觉空间          │      │  滚动消息列表   │   │   │
│  │                                   │      │                 │   │   │
│  │                                   │      └─────────────────┘   │   │
│  │                                   │                             │   │
│  │                                   │      ┌─────────────────┐   │   │
│  │                                   │      │  Input Area     │   │   │
│  │                                   │      │  ┌───────┬────┐ │   │   │
│  │                                   │      │  │ 输入框│ 🎤 │ │   │   │
│  │                                   │      │  └───────┴────┘ │   │   │
│  │                                   │      └─────────────────┘   │   │
│  │                                   │                             │   │
│  └───────────────────────────────────┴─────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Control Bar (可收起, 高度 64px)                                 │   │
│  │  ┌────────┬────────┬────────┬────────┬────────────────────────┐│   │
│  │  │ 表情   │ 语音   │ 静音   │ 音量   │         [空白]        ││   │
│  │  │ 选择   │ 开关   │ 切换   │ 滑块   │                       ││   │
│  │  └────────┴────────┴────────┴────────┴────────────────────────┘│   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 4.2 响应式断点布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        Responsive Breakpoints                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Mobile (< 640px)                                                       │
│  ┌─────────────────────────┐                                            │
│  │  Header (48px)          │                                            │
│  ├─────────────────────────┤                                            │
│  │                         │                                            │
│  │    3D Character         │  ← 角色占据上半部分                        │
│  │    (50vh)               │                                            │
│  │                         │                                            │
│  ├─────────────────────────┤                                            │
│  │    Chat Area            │  ← 聊天区域占据下半部分                    │
│  │    (可拖拽调整高度)     │                                            │
│  │                         │                                            │
│  │  ┌─────────────────┐   │                                            │
│  │  │ Input + Voice   │   │                                            │
│  │  └─────────────────┘   │                                            │
│  └─────────────────────────┘                                            │
│                                                                         │
│  Tablet (640px - 1024px)                                                │
│  ┌─────────────────────────────────────┐                                │
│  │  Header                              │                                │
│  ├─────────────────────────────────────┤                                │
│  │                     │               │                                │
│  │   3D Character      │  Chat Panel   │  ← 侧边聊天面板较窄            │
│  │   (flex-1)          │  (280px)      │                                │
│  │                     │               │                                │
│  └─────────────────────────────────────┘                                │
│                                                                         │
│  Desktop (≥ 1024px)                                                     │
│  如上方主布局图所示，完整功能展示                                        │
│                                                                         │
│  Large Desktop (≥ 1440px)                                               │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Header                                                          │   │
│  ├──────────┬─────────────────────────────────────┬────────────────┤   │
│  │ 角色     │                                     │   Chat +       │   │
│  │ 列表     │     3D Character (max-width 1200px) │   Controls     │   │
│  │ (240px)  │                                     │   (400px)      │   │
│  └──────────┴─────────────────────────────────────┴────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 4.3 页面导航结构

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        Site Map / Navigation                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  /                          ← 主页 (3D 角色 + 对话)                     │
│  │                                                                      │
│  ├── /settings              ← 设置页面 (模态框或独立页)                 │
│  │   ├── /settings/general     - 通用设置                               │
│  │   ├── /settings/character   - 角色设置                               │
│  │   ├── /settings/voice       - 语音设置                               │
│  │   ├── /settings/llm         - LLM 配置                               │
│  │   └── /settings/privacy     - 隐私设置                               │
│  │                                                                      │
│  ├── /characters            ← 角色选择/管理                             │
│  │   ├── /characters/browse    - 浏览预设角色                           │
│  │   ├── /characters/custom    - 自定义角色                             │
│  │   └── /characters/import    - 导入 VRM                               │
│  │                                                                      │
│  └── /about                 ← 关于页面                                  │
│      ├── /about/privacy        - 隐私政策                               │
│      └── /about/terms          - 服务条款                               │
│                                                                         │
│  模态框 (Overlay)                                                       │
│  ├── QuickSettings Modal    ← 快速设置                                  │
│  ├── Character Detail Modal ← 角色详情                                  │
│  ├── API Config Modal       ← API 配置                                  │
│  └── Chat History Modal     ← 历史对话                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 核心交互流程

### 5.1 首次使用流程 (Onboarding)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Onboarding Flow (首次使用)                          │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Step 1: 欢迎页                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                                                                 │   │
│  │                    ✨ 欢迎来到 Codia                            │   │
│  │                                                                 │   │
│  │              你的 3D AI 虚拟伴侣，随时陪伴你                    │   │
│  │                                                                 │   │
│  │           [动态 3D 角色预览 - 自动播放待机动画]                 │   │
│  │                                                                 │   │
│  │                    [ 开始体验 →]                               │   │
│  │                                                                 │   │
│  │              已有配置？ [导入设置]                              │   │
│  │                                                                 │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  Step 2: 选择角色                                                       │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                                                                 │   │
│  │  选择你的伙伴                                    步骤 1/3       │   │
│  │                                                                 │   │
│  │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐                │   │
│  │  │  角色1 │  │ 角色2  │  │ 角色3  │  │  上传  │                │   │
│  │  │ [预览] │  │ [预览] │  │ [预览] │  │  VRM   │                │   │
│  │  │        │  │   ✓    │  │        │  │  ＋    │                │   │
│  │  │ 活泼型 │  │ 温柔型 │  │ 冷静型 │  │ 自定义 │                │   │
│  │  └────────┘  └────────┘  └────────┘  └────────┘                │   │
│  │                                                                 │   │
│  │                    [← 返回]    [继续 →]                        │   │
│  │                                                                 │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  Step 3: 配置 AI                                                        │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                                                                 │   │
│  │  选择 AI 服务                                    步骤 2/3       │   │
│  │                                                                 │   │
│  │  ┌──────────────────────────────────────────────────────────┐  │   │
│  │  │  ○ 使用内置 AI (推荐)                                    │  │   │
│  │  │     无需配置，立即开始使用                               │  │   │
│  │  │     · 每日 50 条免费消息                                 │  │   │
│  │  └──────────────────────────────────────────────────────────┘  │   │
│  │                                                                 │   │
│  │  ┌──────────────────────────────────────────────────────────┐  │   │
│  │  │  ○ 使用自己的 API                                        │  │   │
│  │  │     配置 OpenAI / Claude / Ollama                        │  │   │
│  │  │     [配置 API →]                                         │  │   │
│  │  └──────────────────────────────────────────────────────────┘  │   │
│  │                                                                 │   │
│  │                    [← 返回]    [继续 →]                        │   │
│  │                                                                 │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  Step 4: 语音设置 (可选)                                                │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                                                                 │   │
│  │  语音设置                                        步骤 3/3       │   │
│  │                                                                 │   │
│  │  启用语音交互？                                                 │   │
│  │                                                                 │   │
│  │  ┌──────────────────────────────────────────────────────────┐  │   │
│  │  │  语音输出 (TTS)                              [开启]     │  │   │
│  │  │  让角色用语音回复你                                      │  │   │
│  │  │  音色: [下拉选择▼]  [▶ 试听]                             │  │   │
│  │  └──────────────────────────────────────────────────────────┘  │   │
│  │                                                                 │   │
│  │  ┌──────────────────────────────────────────────────────────┐  │   │
│  │  │  语音输入 (ASR)                              [开启]     │  │   │
│  │  │  用麦克风与角色对话                                      │  │   │
│  │  │  需要麦克风权限                                          │  │   │
│  │  └──────────────────────────────────────────────────────────┘  │   │
│  │                                                                 │   │
│  │                    [← 返回]    [完成 →]                        │   │
│  │                                                                 │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 5.2 核心对话流程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Chat Interaction Flow                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  1. 用户输入                                                            │
│     ├── 文字输入: 键盘输入 → Enter 发送                                 │
│     │   └── 支持 Shift+Enter 换行                                       │
│     │                                                                   │
│     └── 语音输入: 点击/长按麦克风按钮                                   │
│         ├── 开始录音 → 波形动画显示                                     │
│         ├── 停止录音 → ASR 转文字                                       │
│         └── 确认发送 (或自动发送)                                       │
│                                                                         │
│  2. 发送消息                                                            │
│     ├── 消息气泡出现在右侧 (用户)                                       │
│     ├── 显示 "正在思考..." 占位                                         │
│     └── 角色表情变为 "思考" 状态                                        │
│                                                                         │
│  3. AI 响应                                                             │
│     ├── 流式文字显示 (打字机效果)                                       │
│     ├── 同步 TTS 语音播放                                               │
│     ├── 口型同步动画                                                    │
│     └── 表情随内容变化                                                  │
│                                                                         │
│  4. 完成响应                                                            │
│     ├── 角色回归待机表情                                                │
│     ├── 消息气泡完整显示                                                │
│     └── 输入框重新激活                                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 5.3 语音交互状态机

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Voice Interaction State Machine                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│                          ┌─────────────┐                                │
│                          │   IDLE      │                                │
│                          │  空闲状态   │                                │
│                          └──────┬──────┘                                │
│                                 │                                       │
│                    点击/长按麦克风按钮                                   │
│                                 │                                       │
│                                 ▼                                       │
│                          ┌─────────────┐                                │
│                          │ RECORDING   │                                │
│                          │  录音中     │                                │
│                          │  🔴 红点    │                                │
│                          │  波形动画   │                                │
│                          └──────┬──────┘                                │
│                                 │                                       │
│                    松开按钮 / 点击停止                                   │
│                                 │                                       │
│                                 ▼                                       │
│                          ┌─────────────┐                                │
│                          │ PROCESSING  │                                │
│                          │  处理中     │                                │
│                          │  转圈动画   │                                │
│                          └──────┬──────┘                                │
│                                 │                                       │
│                    ASR 识别完成                                          │
│                                 │                                       │
│                                 ▼                                       │
│                          ┌─────────────┐                                │
│              ┌───────────│ CONFIRMING  │───────────┐                    │
│              │           │  确认文字   │           │                    │
│              │           └─────────────┘           │                    │
│              │                                     │                    │
│         自动发送                              手动编辑                    │
│         (3秒后)                              或取消                      │
│              │                                     │                    │
│              ▼                                     ▼                    │
│       ┌─────────────┐                       ┌─────────────┐             │
│       │   SENT      │                       │  CANCELLED  │             │
│       │  已发送     │                       │   已取消    │             │
│       └──────┬──────┘                       └──────┬──────┘             │
│              │                                     │                    │
│              └─────────────────┬───────────────────┘                    │
│                                │                                        │
│                                ▼                                        │
│                         回到 IDLE 状态                                   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 5.4 表情与情绪流程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Emotion Flow Diagram                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  输入分析                                                               │
│  ├── 用户消息文本                                                       │
│  ├── AI 回复文本                                                        │
│  └── 语音语调 (可选)                                                    │
│                                                                         │
│         ↓                                                               │
│                                                                         │
│  情绪识别                                                               │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │  情绪         触发词/场景                     VRM 表情            │  │
│  ├──────────────────────────────────────────────────────────────────┤  │
│  │  neutral     默认/无明显情绪                  neutral            │  │
│  │  happy       开心/积极词汇/赞美               happy + 微笑       │  │
│  │  sad         悲伤/负面/失落                   sad + 眉毛下垂     │  │
│  │  angry       愤怒/抱怨/不满                   angry + 皱眉       │  │
│  │  surprised   惊讶/意外/突然                   surprised + 睁眼   │  │
│  │  relaxed     放松/安慰/平静                   relaxed + 微笑     │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│         ↓                                                               │
│                                                                         │
│  表情过渡                                                               │
│  ├── 渐变时长: 300-500ms                                                │
│  ├── 缓动函数: ease-out                                                 │
│  └── 混合模式: 线性插值                                                 │
│                                                                         │
│         ↓                                                               │
│                                                                         │
│  持续时间                                                               │
│  ├── 对话期间: 保持当前表情                                             │
│  └── 对话结束: 3秒后回归 neutral                                        │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 6. 组件规范

### 6.1 按钮组件

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        Button Component                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  变体 (Variants)                                                        │
│                                                                         │
│  Primary (主要操作)                                                     │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐          │
│  │   发送消息      │  │   发送消息      │  │   发送消息      │          │
│  │   (默认)        │  │   (hover)       │  │   (disabled)    │          │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘          │
│   bg: primary-500      bg: primary-600      bg: primary-300             │
│   text: white          text: white          text: white                 │
│                        scale: 1.02          opacity: 0.5                │
│                                                                         │
│  Secondary (次要操作)                                                   │
│  ┌─────────────────┐                                                    │
│  │   取消          │  border: secondary-300, bg: transparent           │
│  └─────────────────┘  text: secondary-700                               │
│                                                                         │
│  Ghost (幽灵按钮)                                                       │
│  ┌─────────────────┐                                                    │
│  │   设置          │  bg: transparent, text: secondary-600             │
│  └─────────────────┘  hover: bg-secondary-100                           │
│                                                                         │
│  Icon (图标按钮)                                                        │
│  ┌───────┐                                                              │
│  │  🎤   │  圆形, 48x48px, hover 放大 1.1                               │
│  └───────┘                                                              │
│                                                                         │
│  尺寸 (Sizes)                                                           │
│  ├── sm: h-8, px-3, text-sm                                             │
│  ├── md: h-10, px-4, text-base (默认)                                   │
│  └── lg: h-12, px-6, text-lg                                            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

```tsx
// Button Component API
interface ButtonProps {
  variant: 'primary' | 'secondary' | 'ghost' | 'icon';
  size: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  loading?: boolean;
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
  children: React.ReactNode;
  onClick?: () => void;
}
```

### 6.2 输入框组件

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        Input Component                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Chat Input (对话输入)                                                  │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │ ┌─────────────────────────────────────────────────────────┐ ┌───┐│   │
│  │ │  输入消息...                                            │ │🎤││   │
│  │ └─────────────────────────────────────────────────────────┘ └───┘│   │
│  │  多行文本域, 自动扩展高度 (最大 4 行)                           │   │
│  │  右侧: 发送/语音切换按钮                                         │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  状态                                                                   │
│  ├── 默认: border-secondary-200                                         │
│  ├── 聚焦: border-primary-500, ring-2 ring-primary-200                  │
│  ├── 录音中: border-accent-cyan, glow-voice                             │
│  └── 禁用: bg-secondary-100, cursor-not-allowed                         │
│                                                                         │
│  Settings Input (设置输入)                                              │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  API Key                                                        │   │
│  │  ┌───────────────────────────────────────────────────────────┐ │   │
│  │  │ sk-xxxx...xxxx                                   [👁] [✓] │ │   │
│  │  └───────────────────────────────────────────────────────────┘ │   │
│  │  ✓ API Key 有效                                                 │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│  带标签、密码显示切换、验证状态指示                                     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.3 消息气泡组件

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Message Bubble Component                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  用户消息 (右对齐)                                                      │
│                                            ┌────────────────────────┐   │
│                                            │ 你好，今天心情怎么样？ │   │
│                                            └────────────────────────┘   │
│                                             bg: primary-100             │
│                                             text: secondary-900         │
│                                             border-radius: 16px         │
│                                             尾部指向右侧                │
│                                                                         │
│  AI 消息 (左对齐)                                                       │
│  ┌────────────────────────────────────────────────────────────────┐    │
│  │ 我今天感觉很好呢！有什么想和我聊的吗？                         │    │
│  │                                                                │    │
│  │ 你可以和我分享任何事情，我会认真倾听的。                       │    │
│  └────────────────────────────────────────────────────────────────┘    │
│   bg: secondary-100                                                     │
│   text: secondary-900                                                   │
│   border-radius: 16px                                                   │
│   尾部指向左侧                                                          │
│                                                                         │
│  流式消息 (AI 回复中)                                                   │
│  ┌────────────────────────────────────────────────────────────────┐    │
│  │ 我今天感觉很好呢！有什么想和我█                                │    │
│  └────────────────────────────────────────────────────────────────┘    │
│   光标闪烁动画                                                          │
│                                                                         │
│  思考中状态                                                             │
│  ┌────────────────────────────────────────────────────────────────┐    │
│  │  ● ● ●  (跳动动画)                                             │    │
│  └────────────────────────────────────────────────────────────────┘    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.4 语音控制组件

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Voice Control Component                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  麦克风按钮                                                             │
│                                                                         │
│  空闲状态              录音状态              处理状态                    │
│  ┌───────┐            ┌───────┐            ┌───────┐                   │
│  │       │            │  🔴   │            │  ⟳   │                   │
│  │  🎤   │            │  🎤   │            │  ...  │                   │
│  │       │            │       │            │       │                   │
│  └───────┘            └───────┘            └───────┘                   │
│   48x48px             border 发光           旋转动画                    │
│   bg-secondary-100    glow-voice           bg-amber-100                 │
│                       波形动画环绕                                       │
│                                                                         │
│  波形可视化                                                             │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │    ▌  ▌   ▌ ▌▌▌  ▌   ▌▌▌▌   ▌▌  ▌   ▌▌▌▌▌   ▌  ▌▌   ▌         │   │
│  │  ▌ ▌▌ ▌▌▌ ▌▌▌▌▌▌ ▌▌▌ ▌▌▌▌▌▌ ▌▌▌▌▌▌▌ ▌▌▌▌▌▌▌ ▌▌ ▌▌▌▌ ▌▌       │   │
│  │ ▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌      │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│   实时音频波形                                                          │
│   height 基于音量                                                       │
│   color: accent-cyan                                                    │
│                                                                         │
│  音量控制                                                               │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  🔊  ─────●──────────────────────────────────────  100%         │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│   Slider 组件                                                           │
│   track: secondary-200                                                  │
│   thumb: primary-500                                                    │
│   filled: primary-400                                                   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.5 设置面板组件

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Settings Panel Component                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  设置页面结构                                                           │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  ┌──────────────────┐  ┌─────────────────────────────────────┐ │   │
│  │  │  导航菜单        │  │  内容区域                           │ │   │
│  │  │                  │  │                                     │ │   │
│  │  │  ○ 通用设置      │  │  通用设置                           │ │   │
│  │  │  ● 角色设置 ←    │  │  ─────────────────────────────────  │ │   │
│  │  │  ○ 语音设置      │  │                                     │ │   │
│  │  │  ○ LLM 配置      │  │  角色名称                           │ │   │
│  │  │  ○ 隐私设置      │  │  ┌─────────────────────────────┐   │ │   │
│  │  │                  │  │  │ Aria                        │   │ │   │
│  │  │                  │  │  └─────────────────────────────┘   │ │   │
│  │  │                  │  │                                     │ │   │
│  │  │                  │  │  角色人设                           │ │   │
│  │  │                  │  │  ┌─────────────────────────────┐   │ │   │
│  │  │                  │  │  │ 你是一个温柔的陪伴者...    │   │ │   │
│  │  │                  │  │  └─────────────────────────────┘   │ │   │
│  │  │                  │  │                                     │ │   │
│  │  └──────────────────┘  └─────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  设置项类型                                                             │
│  ├── Toggle: 开关切换 (语音启用/禁用)                                   │
│  ├── Select: 下拉选择 (LLM 模型选择)                                    │
│  ├── Slider: 滑块 (音量、语速)                                          │
│  ├── Input: 文本输入 (API Key、角色名称)                                │
│  └── Textarea: 多行文本 (角色人设)                                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.6 3D 角色展示区域

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     3D Character Canvas                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  画布区域                                                               │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                                                                 │   │
│  │                         ┌───────────┐                           │   │
│  │                         │           │                           │   │
│  │                         │   VRM     │  ← 角色居中               │   │
│  │                         │   角色    │     占画布 60% 高度       │   │
│  │                         │           │                           │   │
│  │                         │           │                           │   │
│  │                         └───────────┘                           │   │
│  │                                                                 │   │
│  │  ┌───────┐                                           ┌───────┐ │   │
│  │  │ 表情  │  ← 快捷操作悬浮按钮                       │ 摄像  │ │   │
│  │  └───────┘    半透明，hover 显示                     │ 位置  │ │   │
│  │                                                      └───────┘ │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  背景样式                                                               │
│  ├── 纯色: 渐变背景 (primary-50 → secondary-100)                        │
│  ├── 场景: 简约室内场景 (未来支持)                                      │
│  └── 自定义: 用户上传背景 (未来支持)                                    │
│                                                                         │
│  摄像机控制                                                             │
│  ├── 默认视角: 正面半身                                                 │
│  ├── 缩放: 滚轮/双指缩放                                                │
│  ├── 旋转: 拖拽旋转 (限制范围 ±45°)                                     │
│  └── 重置: 双击回到默认视角                                             │
│                                                                         │
│  加载状态                                                               │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                                                                 │   │
│  │                    ◐ 加载中...                                  │   │
│  │                    正在加载 3D 模型                             │   │
│  │                    ═══════════════ 75%                         │   │
│  │                                                                 │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│   骨架屏 + 进度条                                                       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 7. 响应式设计

### 7.1 断点定义

```typescript
const breakpoints = {
  sm: '640px',   // 小屏手机
  md: '768px',   // 大屏手机/小平板
  lg: '1024px',  // 平板/小桌面
  xl: '1280px',  // 桌面
  '2xl': '1536px', // 大桌面
};
```

### 7.2 移动端适配策略

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Mobile Layout Strategy                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  布局调整                                                               │
│  ├── 3D 角色区域: 固定高度 50vh，可拖拽调整                             │
│  ├── 聊天区域: 占据剩余空间                                             │
│  ├── 侧边栏: 转为底部抽屉或全屏模态                                     │
│  └── 控制栏: 简化为浮动按钮组                                           │
│                                                                         │
│  交互适配                                                               │
│  ├── 点击区域: 最小 44x44px (符合 WCAG)                                 │
│  ├── 手势: 支持滑动、长按、双指缩放                                     │
│  ├── 键盘: 虚拟键盘弹出时调整布局                                       │
│  └── 横屏: 支持横屏模式 (角色 + 聊天并排)                               │
│                                                                         │
│  性能优化                                                               │
│  ├── 3D 渲染: 降低质量 (减少多边形、简化阴影)                           │
│  ├── 动画: 减少粒子效果                                                 │
│  └── 图片: 自适应加载更小的资源                                         │
│                                                                         │
│  移动端特有功能                                                         │
│  ├── PWA 安装提示                                                       │
│  ├── 分享到社交媒体                                                     │
│  └── 相机访问 (未来表情捕捉)                                            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 7.3 触摸交互

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Touch Interactions                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  手势映射                                                               │
│  ├── 单击: 选择/激活                                                    │
│  ├── 长按 (500ms): 语音输入                                             │
│  ├── 双击: 重置摄像机视角                                               │
│  ├── 单指拖拽: 旋转角色                                                 │
│  ├── 双指捏合: 缩放                                                     │
│  └── 下拉: 刷新/加载更多历史                                            │
│                                                                         │
│  触觉反馈 (Haptic)                                                      │
│  ├── 按钮点击: 轻触 (light)                                             │
│  ├── 语音开始: 中等 (medium)                                            │
│  ├── 发送成功: 轻触 (light)                                             │
│  └── 错误: 重击 (heavy)                                                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 8. 动效设计

### 8.1 动效原则

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Animation Principles                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  1. 目的性 (Purposeful)                                                 │
│     每个动画都有明确目的：引导注意力、反馈操作、表达状态                 │
│                                                                         │
│  2. 自然感 (Natural)                                                    │
│     使用弹性曲线，模拟物理运动，避免线性动画                            │
│                                                                         │
│  3. 快速性 (Snappy)                                                     │
│     交互反馈 < 100ms，过渡动画 200-400ms                                 │
│                                                                         │
│  4. 一致性 (Consistent)                                                 │
│     相同类型的动画使用统一的时长和缓动                                  │
│                                                                         │
│  5. 可减弱 (Reducible)                                                  │
│     尊重系统 "减少动效" 设置                                            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 8.2 动效规范

```typescript
// 时长规范
const duration = {
  instant:  '50ms',   // 颜色变化、透明度
  fast:     '150ms',  // 按钮状态、hover
  normal:   '250ms',  // 面板展开、页面过渡
  slow:     '400ms',  // 模态框、复杂过渡
  slower:   '600ms',  // 入场动画
};

// 缓动函数
const easing = {
  // 标准缓动
  easeOut: 'cubic-bezier(0.16, 1, 0.3, 1)',      // 大多数动画
  easeIn:  'cubic-bezier(0.4, 0, 1, 1)',         // 退出动画
  easeInOut: 'cubic-bezier(0.4, 0, 0.2, 1)',     // 对称动画

  // 弹性缓动
  spring:  'cubic-bezier(0.175, 0.885, 0.32, 1.275)', // 弹跳效果
  bounce:  'cubic-bezier(0.68, -0.55, 0.265, 1.55)',  // 强弹跳
};
```

### 8.3 关键动画

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Key Animations                                      │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  页面加载                                                               │
│  ├── Logo 淡入 + 缩放 (0 → 1, 600ms)                                    │
│  ├── 进度条填充 (0 → 100%, 连续)                                        │
│  └── 内容区域滑入 (从底部 20px, 400ms)                                  │
│                                                                         │
│  角色加载                                                               │
│  ├── 骨架屏闪烁 (脉冲动画)                                              │
│  ├── 模型淡入 (opacity 0 → 1, 400ms)                                    │
│  └── 待机动画开始 (自然过渡)                                            │
│                                                                         │
│  消息发送                                                               │
│  ├── 用户气泡: 从右侧滑入 + 淡入 (200ms)                                │
│  ├── 思考动画: 三个点依次跳动 (无限循环)                                │
│  └── AI 气泡: 从左侧滑入 + 文字流式显示                                 │
│                                                                         │
│  语音交互                                                               │
│  ├── 麦克风激活: 边框发光 + 脉冲 (循环)                                 │
│  ├── 波形显示: 实时音量条动画                                           │
│  └── 处理中: 圆形进度旋转                                               │
│                                                                         │
│  表情切换                                                               │
│  ├── BlendShape 线性插值 (300ms)                                        │
│  ├── 眼睛眨动: 随机间隔 (2-5秒)                                         │
│  └── 呼吸动画: 轻微起伏 (连续)                                          │
│                                                                         │
│  口型同步                                                               │
│  ├── Viseme 切换: 60fps 平滑过渡                                        │
│  ├── 嘴型强度: 基于音量动态调整                                         │
│  └── 静音时: 缓慢回归闭嘴 (200ms)                                       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 8.4 Lottie/Rive 动画资源

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Animation Assets                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  需要的动画资源                                                         │
│  ├── loading-spinner.json    - 加载旋转                                 │
│  ├── thinking-dots.json      - 思考中三点跳动                           │
│  ├── voice-wave.json         - 语音波形                                 │
│  ├── send-success.json       - 发送成功勾选                             │
│  ├── error-shake.json        - 错误抖动                                 │
│  ├── confetti.json           - 庆祝撒花 (成就解锁)                       │
│  └── heart-beat.json         - 心跳动画 (情感反馈)                       │
│                                                                         │
│  规格要求                                                               │
│  ├── 格式: Lottie JSON (优先) 或 Rive                                   │
│  ├── 尺寸: 导出 2x 以支持高清屏                                         │
│  ├── 帧率: 60fps                                                        │
│  └── 文件大小: 单个 < 50KB                                              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 9. 可访问性设计

### 9.1 WCAG 2.2 AA 合规

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Accessibility Checklist                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  感知性 (Perceivable)                                                   │
│  ├── [✓] 颜色对比度 ≥ 4.5:1 (正文), ≥ 3:1 (大文字)                     │
│  ├── [✓] 非文本内容有替代文本 (alt, aria-label)                         │
│  ├── [✓] 不仅依赖颜色传达信息 (加图标/文字)                             │
│  ├── [✓] 媒体有字幕/文字替代                                            │
│  └── [✓] 文字可缩放至 200% 不丢失功能                                   │
│                                                                         │
│  可操作性 (Operable)                                                    │
│  ├── [✓] 所有功能可通过键盘访问                                         │
│  ├── [✓] 焦点顺序合理 (tabindex)                                        │
│  ├── [✓] 焦点可见 (focus-visible 样式)                                  │
│  ├── [✓] 可跳过重复内容 (skip link)                                     │
│  ├── [✓] 触摸目标 ≥ 44x44px                                             │
│  └── [✓] 动画可暂停/停止                                                │
│                                                                         │
│  可理解性 (Understandable)                                              │
│  ├── [✓] 页面语言声明 (lang="zh-CN")                                    │
│  ├── [✓] 表单有明确标签                                                 │
│  ├── [✓] 错误信息清晰可操作                                             │
│  └── [✓] 导航一致                                                       │
│                                                                         │
│  健壮性 (Robust)                                                        │
│  ├── [✓] 语义化 HTML                                                    │
│  ├── [✓] ARIA 属性正确使用                                              │
│  └── [✓] 支持辅助技术 (屏幕阅读器)                                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 9.2 键盘导航

```typescript
// 键盘快捷键
const keyboardShortcuts = {
  // 全局
  'Escape': '关闭当前弹窗/取消操作',
  'Tab': '下一个焦点元素',
  'Shift+Tab': '上一个焦点元素',
  '?': '显示键盘快捷键帮助',

  // 对话
  'Enter': '发送消息',
  'Shift+Enter': '消息换行',
  'Ctrl+V': '语音输入开关',

  // 3D 角色
  'ArrowLeft/Right': '旋转角色',
  '+/-': '缩放',
  'Home': '重置视角',

  // 设置
  'Ctrl+,': '打开设置',
};
```

### 9.3 屏幕阅读器支持

```tsx
// ARIA 标注示例
<main role="application" aria-label="AI 虚拟伴侣">
  <section aria-label="3D 角色展示区">
    <canvas
      role="img"
      aria-label="3D 虚拟角色 Aria，当前表情：开心"
    />
  </section>

  <section aria-label="对话区域">
    <div role="log" aria-live="polite" aria-relevant="additions">
      {messages.map(msg => (
        <article
          role="article"
          aria-label={`${msg.sender} 说：${msg.content}`}
        />
      ))}
    </div>

    <form aria-label="发送消息">
      <textarea
        aria-label="输入消息"
        aria-describedby="input-hint"
      />
      <span id="input-hint" className="sr-only">
        按 Enter 发送，Shift+Enter 换行
      </span>
    </form>
  </section>
</main>
```

### 9.4 减少动效模式

```typescript
// 检测系统偏好
const prefersReducedMotion = window.matchMedia(
  '(prefers-reduced-motion: reduce)'
).matches;

// 条件动画
const animationConfig = prefersReducedMotion
  ? { duration: 0 }  // 禁用动画
  : { duration: 250, easing: 'easeOut' };

// CSS 媒体查询
// @media (prefers-reduced-motion: reduce) {
//   *, *::before, *::after {
//     animation-duration: 0.01ms !important;
//     transition-duration: 0.01ms !important;
//   }
// }
```

---

## 10. 设计交付物

### 10.1 设计资源清单

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Design Deliverables                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  设计文件                                                               │
│  ├── Figma 设计稿                                                       │
│  │   ├── 组件库 (Design System Components)                              │
│  │   ├── 页面设计 (Desktop + Mobile)                                    │
│  │   ├── 原型 (Interactive Prototype)                                   │
│  │   └── 标注规范 (Dev Mode)                                            │
│  │                                                                      │
│  ├── 图标资源                                                           │
│  │   ├── SVG 图标 (Lucide Icons 子集)                                   │
│  │   ├── App Icon (各尺寸 PNG + SVG)                                    │
│  │   └── Favicon (ico + png)                                            │
│  │                                                                      │
│  ├── 动画资源                                                           │
│  │   ├── Lottie JSON 文件                                               │
│  │   └── CSS 动画代码片段                                               │
│  │                                                                      │
│  └── 开发规范                                                           │
│      ├── Tailwind 配置 (tailwind.config.js)                             │
│      ├── CSS 变量定义 (globals.css)                                     │
│      └── 组件 API 文档                                                  │
│                                                                         │
│  交付格式                                                               │
│  ├── Figma 链接 (查看/评论权限)                                         │
│  ├── 导出 PNG (2x 用于开发参考)                                         │
│  ├── SVG 导出 (图标和矢量图形)                                          │
│  └── Storybook 组件库 (开发中)                                          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 10.2 Tailwind CSS 配置

```typescript
// tailwind.config.ts
import type { Config } from 'tailwindcss';

const config: Config = {
  content: ['./src/**/*.{js,ts,jsx,tsx,mdx}'],
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#FDF4FF',
          100: '#FAE8FF',
          200: '#F5D0FE',
          300: '#F0ABFC',
          400: '#E879F9',
          500: '#D946EF',
          600: '#C026D3',
          700: '#A21CAF',
          800: '#86198F',
          900: '#701A75',
        },
        secondary: {
          50: '#F8FAFC',
          100: '#F1F5F9',
          200: '#E2E8F0',
          300: '#CBD5E1',
          400: '#94A3B8',
          500: '#64748B',
          600: '#475569',
          700: '#334155',
          800: '#1E293B',
          900: '#0F172A',
        },
        accent: {
          cyan: '#22D3EE',
          green: '#22C55E',
          amber: '#F59E0B',
          red: '#EF4444',
        },
      },
      fontFamily: {
        sans: ['Inter', 'Noto Sans SC', 'system-ui', 'sans-serif'],
        mono: ['JetBrains Mono', 'monospace'],
      },
      borderRadius: {
        DEFAULT: '8px',
        md: '12px',
        lg: '16px',
        xl: '24px',
      },
      boxShadow: {
        'glow-primary': '0 0 20px rgb(217 70 239 / 0.3)',
        'glow-voice': '0 0 20px rgb(34 211 238 / 0.4)',
      },
      animation: {
        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
        'bounce-dot': 'bounce-dot 1.4s infinite ease-in-out both',
      },
      keyframes: {
        'bounce-dot': {
          '0%, 80%, 100%': { transform: 'scale(0)' },
          '40%': { transform: 'scale(1)' },
        },
      },
    },
  },
  plugins: [],
};

export default config;
```

### 10.3 组件开发优先级

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     Component Development Priority                      │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  P0 - MVP 必需 (Week 1-2)                                               │
│  ├── Button (所有变体)                                                  │
│  ├── Input / Textarea                                                   │
│  ├── MessageBubble                                                      │
│  ├── ChatInput (with voice button)                                      │
│  ├── VoiceButton                                                        │
│  ├── CharacterCanvas (3D 容器)                                          │
│  └── LoadingSpinner                                                     │
│                                                                         │
│  P1 - 核心功能 (Week 3-4)                                               │
│  ├── SettingsPanel                                                      │
│  ├── CharacterSelector                                                  │
│  ├── VolumeSlider                                                       │
│  ├── Modal / Dialog                                                     │
│  ├── Dropdown / Select                                                  │
│  └── Toast / Notification                                               │
│                                                                         │
│  P2 - 体验增强 (Week 5-6)                                               │
│  ├── Onboarding 引导组件                                                │
│  ├── EmotionPicker                                                      │
│  ├── WaveformVisualizer                                                 │
│  ├── ProgressBar                                                        │
│  └── Tooltip                                                            │
│                                                                         │
│  P3 - 未来迭代                                                          │
│  ├── CharacterCustomizer                                                │
│  ├── ChatHistory                                                        │
│  ├── ThemeSwitcher                                                      │
│  └── ExportDialog                                                       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 附录

### A. 设计资源链接

| 资源 | 链接 | 说明 |
|------|------|------|
| Figma 设计稿 | [待创建] | 完整设计文件 |
| 图标库 | [Lucide Icons](https://lucide.dev) | 开源图标 |
| 字体 | [Google Fonts](https://fonts.google.com) | Inter + Noto Sans SC |
| 动画 | [LottieFiles](https://lottiefiles.com) | 动画资源 |
| 色彩工具 | [Tailwind Colors](https://tailwindcss.com/docs/customizing-colors) | 色彩参考 |

### B. 设计决策记录

| 决策 | 选项 | 选择 | 理由 |
|------|------|------|------|
| 配色方案 | 冷色/暖色 | 暖色 (粉紫) | 更符合陪伴产品温暖感 |
| 布局方式 | 侧边栏/底部 | 侧边栏 (桌面) | 最大化 3D 展示空间 |
| 图标风格 | 填充/线性 | 线性 | 更轻量现代 |
| 字体 | 系统字体/自定义 | 自定义 (Inter) | 更好的排版控制 |
| 动画库 | Framer Motion/CSS | Framer Motion | 更强大的动画控制 |

### C. 竞品设计参考

| 产品 | 参考点 | 学习内容 |
|------|--------|----------|
| Character.AI | 对话界面 | 消息气泡、流式显示 |
| Replika | 情感表达 | 表情反馈、亲密度设计 |
| VTube Studio | 3D 展示 | 摄像机控制、背景设置 |
| Notion | 设置界面 | 简洁布局、分组逻辑 |
| Discord | 聊天体验 | 消息列表、输入区域 |

---

**文档结束**

*此文档将随设计迭代持续更新。*
